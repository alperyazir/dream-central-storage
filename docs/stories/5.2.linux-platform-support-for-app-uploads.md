# Story 5.2: Linux Platform Support for App Uploads

## Status

Done

## Story

**As an** administrator,
**I want** to upload Linux application builds through the admin panel,
**so that** Dream Central Storage can serve all desktop platforms from one interface.

## Acceptance Criteria

1. Linux appears as a selectable platform in the app upload UI and defaults to appropriate helper text.
2. Selecting Linux routes the upload to the correct API endpoint or payload attribute (e.g., `platform=linux`) and persists artifacts under `apps/linux` in storage.
3. Dashboard listings clearly display Linux builds, including platform badges and download actions.
4. Automated tests cover the Linux selection, payload formation, and dashboard rendering.
5. Documentation of supported platforms reflects the addition of Linux.

## Tasks / Subtasks

- [x] Extend backend upload routing to recognise Linux builds and ensure storage paths align with the `apps/{platform}` convention (AC: 2) [Source: docs/stories/2.3.application-build-folder-upload-endpoint.md#dev-notes]
- [x] Update admin panel upload modal and helper text to surface Linux as an option (AC: 1) [Source: docs/stories/3.4.book-and-app-folder-upload-ui.md#acceptance-criteria]
  - [x] Reuse or extend shared enumerations/types for supported platforms so Linux is available throughout the UI and API clients (AC: 1, 2) [Source: docs/architecture/13-development-workflow.md#shared-contracts]
- [x] Ensure dashboard list components render Linux badges/icons and link to stored assets (AC: 3) [Source: docs/stories/3.3.dashboard-for-listing-books-apps.md#acceptance-criteria]
  - [x] Adjust responsive layouts if the additional badge impacts existing breakpoints (AC: 3) [Source: docs/prd/user-interface-design-goals.md#responsive-behavior]
- [x] Add automated tests for the new platform path across backend and frontend layers (AC: 4) [Source: docs/architecture/16-testing-strategy.md#16-testing-strategy]
- [x] Refresh product documentation and release notes to highlight Linux support (AC: 5) [Source: docs/prd/requirements.md#platform-support]

## Dev Notes

### Previous Story Insights

- Story 3.3 established the dashboard listings and hard-coded platform list; expect to centralize the enumeration rather than scatter new constants. [Source: docs/stories/3.3.dashboard-for-listing-books-apps.md#dev-notes]
- Story 3.4 implemented the upload modal and platform selection UI; follow its patterns for styling and validation. [Source: docs/stories/3.4.book-and-app-folder-upload-ui.md#dev-notes]

### Data Models

- Review any metadata schemas for app builds to confirm where platform identifiers live and ensure Linux is added consistently. [Source: docs/architecture/4-data-models.md#application-build]

### API Specifications

- App upload endpoints currently partition by platform; confirm whether to reuse existing path parameters or introduce a new endpoint for Linux. [Source: docs/architecture/5-api-specification.md#file-uploads]

### Component Specifications

- Badge components should reuse existing design tokens; add Linux-specific iconography if available without breaking color contrast. [Source: docs/prd/user-interface-design-goals.md#branding]

### File Locations

- Frontend updates reside in `apps/admin-panel/src/features/uploads` and `apps/admin-panel/src/features/apps`. Backend adjustments belong under `apps/api/app/routers/apps.py` and related services. [Source: docs/architecture/12-unified-project-structure.md#12-unified-project-structure]

### Testing Requirements

- Add Vitest coverage for the UI selection and snapshot updates; include Pytest coverage for the Linux path and storage interactions. [Source: docs/architecture/16-testing-strategy.md#16-testing-strategy]

### Technical Constraints

- Maintain existing authentication/authorization gatekeeping on upload endpoints. [Source: docs/architecture/15-security-and-performance.md#security]

### Project Structure Notes

- Ensure shared TypeScript types or enums are updated in the `packages/` workspace to avoid drift. [Source: docs/architecture/13-development-workflow.md#shared-contracts]

## Testing

- Frontend: Vitest/RTL coverage for modal and dashboard updates.
- Backend: Pytest coverage for Linux upload routing and storage writes.

## Change Log

| Date       | Version | Description                                           | Author                |
| ---------- | ------- | ----------------------------------------------------- | --------------------- |
| 2025-10-04 | 0.1     | Initial draft created.                                | Sarah (Product Owner) |
| 2025-10-05 | 0.2     | Linux platform support implemented; ready for review. | James (Developer)     |

## Dev Agent Record

### Agent Model Used

GPT-5 Codex (Developer Mode)

### Debug Log References

- `pytest` (apps/api)
- `npm test -- --run` (apps/admin-panel)

### Completion Notes List

- Added Linux to the backend upload whitelist and storage listings, plus new pytest coverage for upload, delete, and listing flows.
- Extended admin platform constants, upload dialog messaging, and Vitest suites to surface Linux as a selectable option with accompanying success/error handling.
- Updated product documentation to record Linux build support in functional requirements.

### File List

- apps/api/app/routers/apps.py
- apps/api/tests/test_apps_upload.py
- apps/api/tests/test_security.py
- apps/api/tests/test_storage_endpoints.py
- apps/admin-panel/src/lib/platforms.ts
- apps/admin-panel/src/**tests**/auth.test.tsx
- apps/admin-panel/src/**tests**/dashboard.test.tsx
- docs/prd/requirements.md
- docs/stories/5.2.linux-platform-support-for-app-uploads.md

## QA Results

- Not yet reviewed.
